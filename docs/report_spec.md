# Signal Report Production Spec

## Purpose
Signal Reports are the canonical operator intelligence artifact for STI. Every asset (social, slides, landing page) points back to the Market-Path dossier bundle (Markdown + PDF) generated by `run_report.py`. The spec below mirrors the shared `REPORT_CONTRACT` in `config.py` so prompt writers, template authors, and QA all work from one contract.

## Core Contract
- **Title prefix:** `Signal Report — {topic}`
- **Sections (H2 order):** Executive Summary, Signal Map, Quant Anchors, Measurement Plan, Deep Analysis, Historical & Contemporary Pattern Matches, Brand & Operator Outcomes, Activation Kit — Brand Collab Lab Handoff, Risk Radar, Future Outlook, Sources.
- **Targets:** ~2,600 words, ~18 min read, 3–5 images (hero, signal map, 1–3 vignettes).
- **CTAs:**
  - Primary: “Talk to Brand Collab Lab” button beneath Executive Summary.
  - Activation CTA: “Want this play translated for your brand? → /collab-lab”.

## Voice & Formatting
1. Paragraphs are 2–4 sentences. Break after the fourth sentence.
2. Use **bold** only for key numbers or decisive moves (e.g., **10–15% uplift**).
3. Insert micro-headings (`###`) every 3–5 paragraphs inside text-heavy sections.
4. Each signal must include `Operator move:` with owner, window, KPI, testable in ≤8 weeks.
5. Every qualitative claim references a number or time box (“within 8 weeks”, “20–30% share”).
6. Enforce H1/H2/H3: H1 = title, H2 per contract, H3 from subsection titles.
7. Maximum line length 80 characters (handled by CSS but verify when editing template copy).

## Quant & Test Targets (Holiday template)
- Foot-traffic uplift detect 10–15% (stretch ≥25%).
- Early-window share goal 20–30% of transactions (baseline 12–15%).
- Event CPA target ≤0.80× baseline.
- QR/scan redemption ≥5% of footfall.
- Paired metrics: Buyer activity share vs SKU promo share (move metric 1 up, hold metric 2 flat).

## Image Briefs
- Exactly 3–5 briefs per report: hero, signal map, up to three case studies.
- Style: polished editorial, confident highlights, abstract timing metaphors, no literal UI.
- Alt text ≤ 120 characters, describe operators/actions.
- `image_generator.py` logs warnings if we fall outside the count.

## CTA Enforcement
- Template pulls CTA copy from `REPORT_CONTRACT['cta']`.
- Do not hard-code URLs/text in prompts; update config once if copy changes.

## QA Checklist (automated + manual)
1. `_qa_report` flags: signal count, operator moves, paragraph sentence cap, activation CTAs, read time.
2. Dossier headings cover every required section (Executive Take → Signal Thesis → Measurement Spine → Operator Moves → Risks).
3. Image manifest count between 3 and 5; alt text present.
4. CTA copy surfaces in the Executive Take and Operator Moves sections.
5. Run `python3 -m pytest tests/test_confidence.py tests/test_html_converter.py` before publishing.
6. Manual review the Markdown (`market_path_report.md`) and PDF to ensure typography and section ordering hold.

## Production Runbook
1. Set `OPENAI_API_KEY` (and `SEARXNG` env if needed).
2. `python3 run_report.py` (or invoke via automation pipeline).
3. Review `/sti_reports/<timestamp>/market_path_report.md` (and the matching PDF) in a Markdown reader.
4. Verify metadata + JSONLD for downstream distribution.
5. Publish dossier bundle plus supporting assets.

Keep this doc updated whenever the contract or CTA copy changes so prompt writers and template owners stay aligned.
